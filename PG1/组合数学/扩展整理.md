# 组合数学

## 第二章 排列组合

### 公式

#### 无重集排列

1. 对于$r \leq n$, $p(n, r) = \frac {n!} {(n-r)!}$

2. 从$n$个元素的集合中任取$r$个的圆排列的个数为
   $$
   \frac {p(n, r)} {r} = \frac {n!} {r \cdot (n-r)!}
   $$

#### 无重集的排列

1. 对于$r \leq n$，
   $$
   C(n, r) = \frac {p(n, r)} {r!} = \frac {n!} {r! \cdot {(n-r)!}}
   $$

#### 重集的排列

1. 若$S$是含有$k$个不同元素而每个元素具有无限重复数的重集，则$S$的$r$排列的个数为$k^r$.
2. 设重集$S$有$k$个不同元素$a_1, a_2,\dots, a_k$，其有限重复数分别为$n_1, n_2,\dots,n_k$，且$n = n
   _1+n_2+ \dots + n_k$，则$S$的排列个数等于$\frac {n!} {n_1! n_2! \dots n_k!}$

#### 重集的组合

1. 设$S$是有$k$个不同元素的重集，且每个元素的重复数是无限的，设$S$的$r$组合个数等于P
   $$
   C(k-1+r, r) = \frac {[k]^r} {r!}
   $$

2. 设$S$是有$k$个不同元素的重集，且每个元素的重复数是无限的，若要求每个不同元素至少在$r$组合中出现一次。设$S$的$r$组合个数等于$C(r-1, k-1)$

3. 2的推论，将$r$个相同元素放入$n$个不同元素的盒而使每个盒中至少含有$q$个元素的分配方法的个数为$C(n-nq+r-1, n-1)$

### 例题

1. 能整除1400的整数的个数有多少个？

   解：
   $$
   1400 = 2^3 \cdot 5^2 \cdot 7^1
   $$
   即求$\{ 3\cdot2,  2\cdot5, 1\cdot7\}$的0组合，1组合、2组合、3组合、4组合、5组合、6组合的总数。

   所以：
   $$
   1+3+5+6+5+3+1 = 24 \\
   $$
   
   另解，由
   $$
   P(1+x+x^2+x^3)\cdot(1+y+y^2)\cdot(1+z)\\得到：(1+1+1+1)\cdot(1+1+1)\cdot(1+1)=24
   $$
   
2. 已知$S=\{5 \cdot a, 3 \cdot b\}$，求$S$的排列个数和6-排列的个数

   解：$S$的排列个数为$\frac {(5+3)!} {5! \cdot 3!}=56$
   
   ​		$S$的6-子重集有$S_1=\{5 \cdot a, 1 \cdot b\}, S_1=\{4 \cdot a, 2 \cdot b\}, S_1=\{3 \cdot a, 3 \cdot b\}$，故$S$的6-排列个数为
   $$
   \frac {6!} {5! \cdot 1!} +\frac {6!} {4! \cdot 2!}+\frac {6!} {3! \cdot 3!} = 6+10+20=36
   $$

3. 求1000！的末尾有多少个0？

   解：
   $$
   \left \lfloor \frac {1000} {5} \right\rfloor + \left \lfloor\frac {1000} {5^2} \right\rfloor+\left \lfloor \frac {1000} {5^3} \right\rfloor + \left \lfloor \frac {1000} {5^3} \right\rfloor + \left \lfloor \frac {1000} {5^4} \right \rfloor + \left \lfloor \frac {1000} {5^5} \right\rfloor + \dots\\
   = \left \lfloor \frac {1000} {5} \right\rfloor + \left \lfloor \frac {1000} {5^2} \right\rfloor+\left \lfloor\frac {1000} {5^3} \right\rfloor + \left \lfloor \frac {1000} {5^3} \right\rfloor + \left \lfloor \frac {1000} {5^4} \right\rfloor
   = 200 + 40 + 8 +1 = 249
   $$

4. 一个车站有1到6个入口。每个入口一次只能通过一个人， 同一伙人共有9个人一同进站，问共有多少中不同的方案？

   解： 逐个安排这9个人。安排第一个人共有6种方案，第二个人有七种，……，第九个人有6+9-1= 14种方案。所以有
   $$
   P(14, 9) = 6*7*8*\dots*14
   $$

## 第三章 容斥原理

### 公式

#### 容斥原理

1. DeMorgan定理

   设$A, B$为全集$U$的任意两个子集，则
   $$
   \overline {A \cup B} = \overline A \cap \overline B \\
   \overline {A \cap B} = \overline A \cup \overline B
   $$

2. 容斥原理

   设$A$和$B$是分别具有性质$P_1$和$P_2$的元素的集合，则$|A \cup B| = |A| + |B|-|A \cap B|$

3. 容斥原理在三个集合上的推广

   设$A, B, C$为任意三个集合，则有
   $$
   |A \cup B \cup C|= |A| +|B| +|C| - |A \cap B|- |A \cap C|-|B \cap C|+|A \cap B \cap C|
   $$

#### 错位排列

定义：错位排列就是使得每个元素都不在原来的位置上。

错位排列递归关系：
$$
D_n = (n-1)(D_{n-1}+D_{n-2})
$$
其中边界条件为$D_1=0, D_2=1, D_0=1$

1. 定理：对于$n\geq1$,
   $$
   D_n = n!\left(1-\frac{1}{1!}+\frac {1} {2!}-\frac{1}{3!}+ \dots+(-1)^n \frac 1 {n!}\right) 
   $$

#### 禁位排列

1. 有禁位的排列数为
   $$
   Q_n = n!-r_1 \cdot (n-1)!+r_2 \cdot (n-2)!- \dots +(-1)^{n-1}r_{n-1} \cdot 1!+(-1)^n r_n \cdot 0!
   $$
   其中$r_i$为有$i$个棋子落入禁止位置上的方案数

### 例题

1. 以$h_n$表示把$n$个球分给3个小孩，使得每个小孩至少分得一个球的不同方法数，求$h_n$.

   解：设$S$为把$n$个球分给三个小孩的不同方法数的集合。

   $A_1, A_2, A_3$为第一、二、三个小孩的没有分到小球不同方法的集合。

   那么，$|S| = 3^n, |A_1|=|A_2|=|A_3|= 2^n$,

   则有，
   $$
   \begin{align}
   h_n=&|\overline{A_1}\cap\overline{A_2}\cap\overline{A_3}|=|\overline {A_1 \cup A_2 \cup A_3}| \\
   =&|S-A_1\cup A_2 \cup A_3|\\
   =&|S|-|A_1|-|A_2|-|A_3|+|A_1 \cap A_2|+|A_1 \cap A_3| +|A_2 \cap A_3|-|A_1 \cap A_2 \cap A_3| \\
   =& 3^n-3*2^n+3
   \end{align}
   $$

## 第四章 鸽巢原理

### 公式

#### 鸽巢原理

1. 若有$n+1$只鸽子飞回$n$个鸽子巢，函数则至少有一个鸽子巢里面有不少于两只鸽子
2. 设$m_1, m_2,\dots, m_n$均为正整数，如果有$m_1+m_2+\dots+m_n-n+1$只鸽子飞回$n$个鸽子巢，则或者第一个鸽子巢有$m_1$只鸽子，或者第二个鸽子巢有$m_2$只鸽子，$\dots$，或者第$n$个鸽子巢有$m_n$只鸽子
   - 推论1：如果$m_1=m_2=\dots=m_n=r$，若将$n \cdot (r-1)+1$个球放入$n$个盒子中，则至少有一个盒子不会少于$r$个球
   - 推论2 ： 如果$n$个正整数$m_1,m_2,\dots,m_n$的平均数$\large{\frac {m_1+m_2+\dots+m_n-n+1} {n}} > r-1$, 则$m_1, m_2,\dots, m_n$中至少有一个正整数不会小于$r$.
   - 推论3：有$m$个球放入$n$个盒子， 则至少有一个盒子中有不少于$\lfloor \frac {m-1} {n} \rfloor+1$个球。

#### Ramsey数

1. 若集合$S$由六个人组成，那么$S$中或者存在至少三个人互相认识，或者是存在至少三个人互相不认识

### 例题函数函数

1. 取黑白混杂的棋子21个，排成三行七列，试证明无论怎样的排法，都可以找到一个小长方形子阵使其四个脚棋子颜色全黑或者全白。

   

2. 任意一群人中必有两个人有相同数目的朋友。



## 第五章 母函数

### 公式定理

#### 幂级数型母函数

1. 对于数列$a_0, a_1, a_2, \dots, a_n, \dots$生成一个函数
   $$
   \begin{align}
   F(x) =& a_0+a_1x+a_2x^2+\dots+a_nx^n+\dots\\
   =& \sum _{i=0}^{\infty}a_ix^i
   \end{align}
   $$
   则称对应数列$a_0, a_1, a_2, \dots, a_n, \dots$的幂级数型母函数。

   - $F(x) = 1+x+x^2+\dots+x^n+\dots = \frac {1} {1-x}$
   - $F(x) = 1+2x+3x^2+\dots+(n+1) \cdot x^n+\dots = \frac {1} {(1-x)^2}$
   - $F(x) = x+2^2x^2+ \dots +n^2x^n+\dots=\frac {x(1+x)}{(1-x)^3}$

#### 指数型母函数

1. 设有$k$种不同的元素的有限可重集合$S=\{n_1 \cdot e_1, n_2 \cdot e_2, \dots, n_k \cdot e_t\}$，且$n=n_1+n_2+\dots+n_k$，任取$r$个元素的排列数记为$b_r$，则对于序列$\{b_r\}$的指数型母函数为
   $$
   \begin{align}
   F_e(x) =& \left(1+x+\frac {x^2} {2!}+\dots+\frac {x^{n_1}}{n_1!}\right) \cdot\left(1+x+\frac {x^2} {2!}+\dots+\frac {x^{n_2}}{n_2!})\right) \dots\left(1+x+\frac {x^2} {2!}+\dots+\frac {x^{n_k}}{n_k!}\right)\\
   \end{align}
   $$
   

#### 拆分数

1. 拆分数定理

   其中$P_1(n)=1, P_n(n)=1,P_2(n) = \lfloor\frac{n}{2}\rfloor, P_3(n) = \lfloor \frac {n^2+3} {12} \rfloor,P_{n-1}(n) =1$

$$
P_k(n) =P_1(n-k)+P_2(n-k)+\dots+P_n(n-k)= \sum_{i=1}^k P_i(n-k)
$$

### 例题

1. 设$n (n \geq 6)$是正整数
   - 把$n$个不同的球分给3个人，使每个人至少分得两个球，有多少种不同的分法？
   
     解：设三个人分别为$m_1,m_2,m_3$，把$n$个不同的球分别分给3个人，相对于对集合$\{\infty\cdot m_1, \infty\cdot m_2, \infty \cdot m_3\}$的$n$个元素进行可重复排列。此处可重复排列中$m_1,m_2,m_3$的重数都大于等于2.
     $$
     \begin{align}
     F_e(x)=&\left( 1+x+\frac {x^2} {2!}+\dots \right)^3\\
     =& e^{3x}-3e^{2x}(x+1)+3e^x(x+1)^2-(x+1)^3\\
     =& \sum^{\infty}_{n=0}3^n \frac{x^n}{n!}-3(x+1)\sum^{\infty}_{n=0}2^n \frac{x^n}{n!}+(2x+1)\sum^{\infty}_{n=0}\frac{x^n}{n!}-(x^3+3x^2+3x+1)
     \end{align}
     $$
     设上述展开式的中，$\frac{x^n}{n!}$的系数为$a_n$则：
     $$
     \begin{align}
     a_n =& 3^n-3n\cdot 2^{n-1}-3\cdot 2^n+3n(n-1)+6n+3\\
     =& 3^n-3(n+2)2^{n-1}+3(n^2+n+1)
     \end{align}
     $$
   
   - 把$n$个相同的球分给3个人，使每个人至少分得两个球，有多少种不同的分法？
   
     解：相当于不定方程$x_1+x_2+x_3 = n$的非负y整数解，且$x_i \geq 2, i=1,2,3$的解的个数。
   
     相当于不定方程$y_1+y_2+y_3 = n-6$的非负整数解的个数。为
     $$
     \left(
     \begin{matrix}
     n-6+2\\
     2
     \end{matrix}
     \right)
     =
     \left(
     \begin{matrix}
     n-4\\
     2
     \end{matrix}
     \right)
     $$
   
   - 把$n$个相同的球分为3堆，使每堆至少分得两个球，有多少种不同的分法？
   
     解：相当于$n$的拆分数，且拆分后的每一个部分都大于或者等于2。即相当于$n-3$的拆分数
     $$
     P_3(n-3)= \left \lfloor \frac {(n-3)^2+3} {12} \right \rfloor=\left \lfloor \frac {n^2-6n} {12} \right \rfloor+1
     $$

2. 求$P_5(10)$

   解：
   $$
   \begin{align}
   P_5(10) \\
   =& P_1(10-5)+P_2(10-5)+P_3(10-5)+P_4(10-5)+P_5(10-5)\\
   =& P_1(5)+P_2(5)+P_3(5)+P_4(5)+P_5(5)\\
   =& 1+2+2+1+1=7
   \end{align}
   $$
   

## 第六章 递归关系

1. Stirling数

   - 性质

     $S_2(n,0)=0, S_2(n,1) =1, S_2(n,2) = 2^{n-1}-1,\\
     S_2(n,n-1) = C(n,2), S_2(n,n) = 1$

   - 递归

     $S_2(n,m) = mS_2(n-1,m)+S_2(n-1,m-1)$

## 第七章 Polya定理

### 公式定理

1. 二元运算

   - 性质：
     - 封闭性
     - 可结合性
     - 可交换性
     - 幺元
     - 逆元

2. Cauchy公式

   $S_n$中属于$1^{\lambda_1}2^{\lambda_2}\dots n^{\lambda_n}$共轭类中共轭元素的个数为
   $$
   h(\lambda_1, \lambda_2, \dots, \lambda_n) = \frac {n!} {\lambda_1!, \lambda_2!, \dots, \lambda_n!\cdot 1^{\lambda_1}2^{\lambda_2}\dots n^{\lambda_n}}
   $$

